<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>查询结果</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <script src="/js/jquery.min.js"></script>
    <!--[if lt IE 9]>
    <script type="text/javascript" src="/js/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript">
        function query() {
            $.ajax({
                type: "POST",
                url: "/admin/query",
                dataType:"json",
                success: function (data) {
                    if (data.code == 400) {
                        alert(data.message)
                    } else {
                        alert(data.message);
                        var str = "<tr> <th>id</th><th>name</th> <th>主题</th> <th>类别</th> <th>createTime</th><th>updateTime</th> <th>操作</th> <th>操作</th> </tr>";
                       for (var i = 0;i < data.data.taskList.length; i++)
                       {
                           str +=  "<tr><td>" + data.data.taskList[i].id
                                   + "</td><td>" + data.data.taskList[i].name
                                   + "</td><td>" + data.data.taskList[i].task_theme
                                   + "</td><td>" + data.data.taskList[i].task_type
                                   + "</td><td>" + data.data.taskList[i].createTime
                                   + "</td><td>" + new Date(parseInt(data.data.taskList[i].updateTime)).toLocaleString()
                                   + "</td><td><form id='deleteForm" + data.data.taskList[i].id
                                   + "'><input type='hidden' name='id' value='" + data.data.taskList[i].id
                                   + "'/><button type='button' onclick='deleteData(" + data.data.taskList[i].id
                                   + ")'>删除</button></form></td><td><a href='/admin/queryone?id="
                                   + data.data.taskList[i].id + "'>查看</a> </td></tr>";
                       }
                        document.getElementById("reuslt").innerHTML += str;
                    }
                },
                error:function(){
                    alert("system error");
                }
            });
        }
    </script>
    <script type="text/javascript">
        function deleteData (taskId) {
            var formId = "#deleteForm" + taskId;
            $.ajax({
                type: "POST",
                url: "/admin/delete",
                data: $(formId).serialize(),
                dataType:"json",
                success: function (data) {
                    if (data.code == 400) {
                        alert(data.message)
                    } else {
                        alert(data.message);
                        window.location.href = '/resultpage/result.html';
                    }
                },
                error:function(){
                    alert("system error");
                }
            });
        }
    </script>
</head>
<body>
<p><input name="queryAll" type="button" value="查询全部" onClick="query()"/></p>
<table id="reuslt"></table>
<script src="/js/excanvas.min.js"></script>
<script src="/js/jquery-ui.custom.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.flot.min.js"></script>
<script src="/js/jquery.flot.resize.min.js"></script>
<script src="/js/jquery.sparkline.min.js"></script>
<script src="/js/fullcalendar.min.js"></script>

<script src="/js/jquery.nicescroll.min.js"></script>
<script src="/js/unicorn.js"></script>
<script src="/js/unicorn.dashboard.js"></script>
</body>
</html>